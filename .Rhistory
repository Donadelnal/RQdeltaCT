enquo()
?read.csv
?pivot_longer
library(tidyverse)
?pivot_longer
library(devtools)
devtools::document()
?prepare_data
devtools::document()
?prepare_data
?RQdeltaCT
?RQdeltaCT
??RQdeltaCT
Ct <- read_Ct(path = "data_Ct_long.txt",
sep = "\t",
dec = ".",
skip = 0,
add.col.Flag = TRUE,
col.Sample = 1, col.Target = 2, col.Ct = 5, col.Group = 9, col.Flag = 4)
library(RQdeltaCT)
Ct <- read_Ct(path = "data_Ct_long.txt",
sep = "\t",
dec = ".",
skip = 0,
add.col.Flag = TRUE,
col.Sample = 1, col.Target = 2, col.Ct = 5, col.Group = 9, col.Flag = 4)
Ct <- mutate(Ct, Flag = ifelse(Flag < 1, "Undetermined", "OK"))
library(tidyverse)
Ct <- mutate(Ct, Flag = ifelse(Flag < 1, "Undetermined", "OK"))
usethis::use_data(Ct)
library(sinew)
sinew::makeOxygen(Ct, add_fields = "source")
library(RQdeltaCT)
system.file("extdata", package = "RQdeltaCT") |> list.files()
library(RQdeltaCT)
system.file("extdata", package = "RQdeltaCT") |> list.files()
system.file("extdata", package = "RQdeltaCT") |> list.files()
#'
#' @examples
#' data_long <- prepare_data(Ct.file = "Ct_wide.txt",
#'                           design.file = "design.txt",
#'                           sep ="\t",
#'                           dec = ".")
#'
#' @importFrom utils read.csv
#' @importFrom tidyr pivot_longer
#'
prepare_data <- function(Ct.file, design.file,  sep, dec){
data_wide <- read.csv(Ct.file,
header = TRUE,
sep = sep,
dec = dec)
data_wide_design <- read.csv(design.file,
header = TRUE,
sep = sep)
colnames(data_wide)[1] <- "Target"
data_slim <- pivot_longer(data_wide, -Target, names_to = "Sample", values_to = "Ct")
data_slim[ ,"Group"] <- NA
for (x in 1:nrow(data_wide_design)) {
index <- which(data_slim$Sample == data_wide_design$Sample[x])
data_slim$Group[index] <- data_wide_design$Group[x]
}
return(data_slim)
}
system.file("extdata", "data_Ct_long.txt", package = "RQdeltaCT")
library(RQdeltaCT)
system.file("extdata", package = "RQdeltaCT") |> list.files()
system.file("extdata", "data_Ct_long.txt", package = "RQdeltaCT")
remove.packages("RQdeltaCT")
library(RQdeltaCT)
credentials::set_github_pat()
remotes::install_github("Donadelnal/RQdeltaCT")
library(RQdeltaCT)
system.file("extdata", "data_Ct_long.txt", package = "RQdeltaCT")
credentials::set_github_pat()
remotes::install_github("Donadelnal/RQdeltaCT")
detach("package:RQdeltaCT", unload = TRUE)
remove.packages("RQdeltaCT")
credentials::set_github_pat()
remotes::install_github("Donadelnal/RQdeltaCT")
credentials::set_github_pat()
remotes::install_github("Donadelnal/RQdeltaCT")
credentials::set_github_pat()
remotes::install_github("Donadelnal/RQdeltaCT")
system.file("extdata", "data_Ct_long.txt", package = "RQdeltaCT")
library(RQdeltaCT)
system.file("extdata", "data_Ct_long.txt", package = "RQdeltaCT")
data(Ct)
library(RQdeltaCT)
library(RQdeltaCT)
system.file("extdata", "clippy.xlsx", package = "readxl")
system.file("extdata", package = "RQdeltaCT") |> list.files()
usethis::document()
library(RQdeltaCT)
library(RQdeltaCT)
library(RQdeltaCT)
data(Ct)
Ct
library(RQdeltaCT)
?mutate
?which
?read.csv
?as.numeric
?mutate
?as.data.frame
?arrange
?cat
?ggplot
library(tidyverse)
?ggplot
?reorder
?geom_bar
?print
?table
?paste
?filter
?sum
?colnames
?legend.position
?as.data.frame
?pivot_wider
?mutate
?as.vector
?unique
?%in%
#' @return vector with names of samples.
#' @export
#'
#' @examples
#' samples.to.remove <- samples_to_remove(sample.Ct.control, 0.5)
#'
#' @importFrom base as.data.frame as.vector
#' @importFrom tidyr pivot_wider
#' @importFrom dplyr mutate filter
#'
exp_Ct <- function(data,
imput.by.mean.within.groups = FALSE,
save.to.txt = FALSE,
name.txt = "expCt"){
data <- data %>%
group_by(Group, Target, Sample) %>%
summarise(mean = base::mean(Ct, na.rm = TRUE), .groups = "keep") %>%
as.data.frame()
calcRQ <- function(x){
x <- 2^-x
}
data_wide <- data %>%
select(Group, Sample, Target, mean) %>%
pivot_wider(names_from = Target, values_from = mean)
nas <- sum(is.na(data_wide))
percentage <- sum(is.na(data_wide))/((ncol(data_wide)-2)*nrow(data_wide))
if (imput.by.mean.within.groups == TRUE){
data_wide_imp_exp <- data_wide %>%
group_by(Group) %>%
mutate(across(where(is.numeric), ~ replace(., is.na(.), mean(., na.rm = TRUE)))) %>%
mutate_at(vars(-c("Group","Sample")), calcRQ)
cat("Data contained", nas, "missing values that constitute", round(percentage*100, 5), "percent of the total data.\n Missing values were imputed using means within compared groups.\n")
if (save.to.txt == TRUE){
write.table(as.data.frame(data_wide_imp), paste(name.txt,".txt", sep = ""))
}
return(data_wide_imp_exp)
} else {
data_wide_exp <- data_wide %>%
mutate_at(vars(-c("Group","Sample")), calcRQ)
cat("Data contains", nas, "missing values that constitute", round(percentage*100, 5), "percent of the total data.")
if (save.to.txt == TRUE){
write.table(as.data.frame(data_wide_exp), paste(name.txt,".txt", sep = ""))
}
return(data_wide_exp)
}
}
?select
?is.na
?ncol
?write.table
?pivot_longer
?rename_with
?shapiro.test
?mean
?sd
?full_join
?t.test
?pvalue
library(coin)
?pvalue
?min
?max
?as.data.frame
?vif
library(RQdeltaCT)
library(RQdeltaCT)
ls("package:RQdeltaCT")
?exp_Ct
?read_Ct_long
?filter_Ct
?RQ_exp_Ct
library(roxygen2)
roxygenise()
roxygenise()
library(roxygen2)
roxygenise()
library(RQdeltaCT)
?boxplot
?dist
?hclust
